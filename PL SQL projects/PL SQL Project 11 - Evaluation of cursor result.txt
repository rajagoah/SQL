â€” THIS CODE BELOW EVALUATE WHICH QUERY TO EXECUTE BASED ON AN EVALUATION CRITERIA
--PLEASE NOTE THAT THIS CODE IS MISSING THE BIT THAT WILL STORE THE RESULT RETURNED BY THE 'EXECUTE IMMEDIATE...' CLAUSE. THAT WILL BE COVERED IN THE NEXT VERSION OF PROJECT 11
SET SERVEROUTPUT ON
DECLARE
    CURSOR C1 IS
    SELECT COL3 FROM TB WHERE COL3 = 3;
    V_COL C1%ROWTYPE;
BEGIN
    OPEN C1;
    FETCH C1 INTO V_COL;
    CLOSE C1;
    IF V_COL.COL3 = 3
    THEN
    EXECUTE IMMEDIATE 'SELECT * FROM TB WHERE COL3 = 3' ;
    ELSE
    EXECUTE IMMEDIATE 'SELECT * FROM TB';
    END IF;
END;



-- a variation of the above code. instead of using dynamic sql, i'm using 2 cursors. the second cursor is being used to store the result returned by the sql within the conditional statement
SET SERVEROUTPUT ON
DECLARE
    CURSOR C1 IS
    SELECT COL3 FROM TB WHERE COL3 = 3;
    V_COL C1%ROWTYPE;
    CURSOR C2 IS
    SELECT COL1, COL2, COL3 FROM TB;
    V_COLS_ALL C2%ROWTYPE;
BEGIN
    OPEN C1;
    FETCH C1 INTO V_COL;
    CLOSE C1;
    IF V_COL.COL3 = 3
    THEN
    SELECT COL1, COL2, COL3 INTO V_COLS_ALL FROM TB WHERE COL3 = 3 ;
    ELSE
    SELECT COL1, COL2, COL3 INTO V_COLS_ALL FROM TB;
    END IF;
END;
