CREATE OR REPLACE PROCEDURE AMAZON_INTERVIEW_2
IS 
TYPE V_TABLES IS TABLE OF VARCHAR2(10000);
V_STATES V_TABLES;
V_STATES_2 V_TABLES;
V_REV V_TABLES;

BEGIN
EXECUTE IMMEDIATE 'SELECT STATES, STATES_2, REVENUE FROM STATES'
BULK COLLECT INTO V_STATES, V_STATES_2, V_REV;

FOR INDX IN 1 .. V_STATES.COUNT
LOOP
    DBMS_OUTPUT.PUT_LINE(V_STATES(INDX)||' '|| V_STATES_2(INDX)||' ' ||V_REV(INDX));
END LOOP;
END;

SET SERVEROUTPUT ON
BEGIN
AMAZON_INTERVIEW_2;
END;
